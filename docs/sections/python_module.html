<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Detailed pyFastChem module description &#8212; FastChem 3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=5bc47236" />
    <script src="../_static/documentation_options.js?v=110ea713"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Internal parameters" href="parameters.html" />
    <link rel="prev" title="Detailed C++ object class description" href="cpp_class.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="detailed-pyfastchem-module-description">
<span id="sec-pyfc-details"></span><h1>Detailed pyFastChem module description<a class="headerlink" href="#detailed-pyfastchem-module-description" title="Link to this heading">¶</a></h1>
<div class="line-block">
<div class="line">By using the library <code class="docutils literal notranslate"><span class="pre">PyBind11</span></code>, <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> can be called directly
within Python. This requires the compilation of <code class="docutils literal notranslate"><span class="pre">FastChem</span></code>’s
Python wrapper that is located in the file
<code class="docutils literal notranslate"><span class="pre">python/fastchem_python_wrapper.cpp</span></code>. <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> currently only
links to the <code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">double</span></code> <code class="docutils literal notranslate"><span class="pre">C++</span></code> version of <code class="docutils literal notranslate"><span class="pre">FastChem</span></code>.</div>
<div class="line">As described <a class="reference internal" href="installation.html#sec-install-config"><span class="std std-ref">here</span></a>, when using the
<code class="docutils literal notranslate"><span class="pre">CMake</span></code> approach, <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> will be automatically compiled when
<code class="docutils literal notranslate"><span class="pre">cmake</span></code> is configured with the corresponding option. If the
configuration and compilation is successful, a module file should be
present in the <code class="docutils literal notranslate"><span class="pre">python/</span></code> folder that contains the Python module
which acts as a wrapper between Python and the <code class="docutils literal notranslate"><span class="pre">C++</span></code> version of
<code class="docutils literal notranslate"><span class="pre">FastChem</span></code>. The file should be named <code class="docutils literal notranslate"><span class="pre">pyfastchem.cpython-xxxx</span></code>,
where <code class="docutils literal notranslate"><span class="pre">xxxx</span></code> will be a combination of your Python version and
operating system.</div>
<div class="line">If <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> has been built using the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> script or
installed via <code class="docutils literal notranslate"><span class="pre">PyPI</span></code>, then the module will be located in your normal
Python module library path. It, thus, can be accessed from everywhere
on your system like any other standard Python package. The location
and additional module information can be obtained via</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>show<span class="w"> </span>pyfastchem
</pre></div>
</div>
<div class="line-block">
<div class="line">Depending on your Python installation, <code class="docutils literal notranslate"><span class="pre">pip</span></code> might need to be
replaced by <code class="docutils literal notranslate"><span class="pre">pip3</span></code>.</div>
<div class="line">A description of the module is given <a class="reference internal" href="#sec-pyfc-module"><span class="std std-ref">here</span></a>. Besides the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module, we also
provide several example Python scripts that show how to call
<code class="docutils literal notranslate"><span class="pre">FastChem</span></code> from within Python for several different scenarios. We
discuss the examples <a class="reference internal" href="pyfastchem.html#sec-pyfc-examples"><span class="std std-ref">here</span></a>.</div>
</div>
<p id="sec-pyfc-module">The <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module provides access to the <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> object
class as well as additional constants used within <code class="docutils literal notranslate"><span class="pre">FastChem</span></code>. They are
essentially identical to their <code class="docutils literal notranslate"><span class="pre">C++</span></code> counterparts discussed <a class="reference internal" href="cpp_class.html#sec-fc-class"><span class="std std-ref">here</span></a>.</p>
<p>To include the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module in your Python project, just import
it using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyfastchem</span>
</pre></div>
</div>
<p>This provides access to the <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> object class as well as the
input and output structures and additional pre-defined constants used by
<code class="docutils literal notranslate"><span class="pre">FastChem</span></code>.</p>
<section id="pyfastchem-constants">
<span id="sec-pfc-constants"></span><h2>pyFastChem constants<a class="headerlink" href="#pyfastchem-constants" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module contains a number of pre-defined constants.
This includes the constant <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_UNKNOWN_SPECIES</span></code> of
type <code class="docutils literal notranslate"><span class="pre">int</span></code> that is returned by some <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> methods when a
chemical species is not found.</div>
<div class="line">The chemistry calculation can also return several output flags of type
<code class="docutils literal notranslate"><span class="pre">int</span></code> defined as constants in the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module:</div>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_SUCCESS</span></code></dt><dd><p>Indicates that the calculation has been successful, i.e. that the chemistry iterations converged.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_NO_CONVERGENCE</span></code></dt><dd><p>Indicates that the calculation was not successful, i.e. that the chemistry did not converge within the allowed maximum number of iterations steps given in the config file or set manually via the <code class="docutils literal notranslate"><span class="pre">setParameter</span></code> method together with the <code class="docutils literal notranslate"><span class="pre">nbIterationsChem</span></code> parameter (see <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>). One way to solve such a problem is to increase the maximum number of iteration steps.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_INITIALIZATION_FAILED</span></code></dt><dd><p>Indicates that something went wrong during reading one of the input files. To find the source of the problem, one can set the verbose level in the config file or manually via <code class="docutils literal notranslate"><span class="pre">setVerboseLevel</span></code> (see <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>) to a higher value and look at the terminal output.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_IS_BUSY</span></code></dt><dd><p>The chemistry calculations of <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> can only be called once for each object class instance. Attempting to start a new calculation while another is still running will result in <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> returning this flag.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_WRONG_INPUT_VALUES</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">FastChem</span></code> returns this flag if some input values are wrong. Currently, this refers to the temperature and pressure vectors in the input structure not having the same size (see <a class="reference internal" href="cpp_class.html#sec-fastchem-input-struct"><span class="std std-ref">here</span></a> for details on the input structure).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_PHASE_RULE_VIOLATION</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">FastChem</span></code> returns this flag if condensation is used and the system violates the phase rule. This happens when the number of elements contained in condensates equals the total number of elements. In this case, the gas phase lacks a degree of freedom to yield the correct gas pressure. Such a system cannot be solved as there has always to be at least one incondensable element in the gas phase (see the section about the phase rule in Paper III).</p>
</dd>
</dl>
<p>In addition to these flags, the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module also includes a
constant string array <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_MSG</span></code> that contains string
expressions for each of these flags. Using this array with any of the
aforementioned flags <code class="docutils literal notranslate"><span class="pre">pyfastchen.FASTCHEM_MSG[flag]</span></code> returns a string
with a description of the corresponding flag’s meaning. For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyfastchem</span><span class="o">.</span><span class="n">FASTCHEM_MSG</span><span class="p">[</span><span class="n">pyfastchem</span><span class="o">.</span><span class="n">FASTCHEM_NO_CONVERGENCE</span><span class="p">]</span>
</pre></div>
</div>
<p>will return the string <code class="docutils literal notranslate"><span class="pre">&quot;convergence</span> <span class="pre">failed&quot;</span></code>.</p>
</section>
<section id="pyfastchem-constructor">
<h2>pyFastChem constructor<a class="headerlink" href="#pyfastchem-constructor" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">Since <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> is written as an object class, an instance of that
class (i.e. an object) needs to be created before <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> can be
used. This is done by calling the constructor of the <code class="docutils literal notranslate"><span class="pre">FastChem</span></code>
class that is contained within the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module. There are
three main ways to call the constructor and create an object.</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChem</span><span class="p">(</span><span class="nb">str</span> <span class="n">element_abundance_file</span><span class="p">,</span>
                    <span class="nb">str</span> <span class="n">gas_species_data_file</span><span class="p">,</span>
                    <span class="nb">int</span> <span class="n">verbose_level</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>This constructor requires three parameters: the locations of the element abundance and gas phase species data files, as well as the verbose level. All other options and parameters within <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> will be set to their default values but can be later changed by using the appropriate methods described <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>. The default maximum number of chemistry iterations is 3000, the number of Newton, bisection and Nelder-Mead method iterations is 3000, and the default accuracy of the of Newton method and the chemistry iterations is set to <span class="math notranslate nohighlight">\(10^{-4}\)</span>. This constructor will not read in any condensate data. Trying to use an object created via this method for a calculation using condensation will result in an error message.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChem</span><span class="p">(</span><span class="nb">str</span> <span class="n">element_abundance_file</span><span class="p">,</span>
                    <span class="nb">str</span> <span class="n">gas_species_data_file</span><span class="p">,</span>
                    <span class="nb">str</span> <span class="n">condensate_species_data_file</span><span class="p">,</span>
                    <span class="nb">int</span> <span class="n">verbose_level</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>This constructor requires four parameters: the locations of the element abundance and gas phase species data files, the condensate data file, as well as the verbose level. All other options and parameters within <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> will be set to their default values but can be later changed by using the appropriate methods described <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>. The default maximum number of chemistry iterations is 3000, the number of Newton, bisection and Nelder-Mead method iterations is 3000, and the default accuracy of the of Newton method and the chemistry iterations is set to <span class="math notranslate nohighlight">\(10^{-4}\)</span>. Note that instead of a location for the condensate data, a <code class="docutils literal notranslate"><span class="pre">str</span></code> containing <code class="docutils literal notranslate"><span class="pre">'none'</span></code> can be used here as well. In that case, no condensate data will be read in and trying to use the object for a calculation using condensation will result in an error message.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChem</span><span class="p">(</span><span class="nb">str</span> <span class="n">parameter_file</span><span class="p">,</span>
                    <span class="nb">int</span> <span class="n">intial_verbose_level</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>The constructor requires two different arguments: the location of the parameter file and the initial verbose level. The latter one will be replaced by the corresponding value read in from the parameter file. The structure of this parameter file is discussed <a class="reference internal" href="input_output.html#sec-fc-parameter-file"><span class="std std-ref">here</span></a>. All of parameter values read in from the file can also be adjusted during runtime by using the methods listed <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>.</p>
</div></blockquote>
</section>
<section id="pyfastchem-input-and-output-structures">
<span id="sec-pfc-input-ouput-struct"></span><h2>pyFastChem input and output structures<a class="headerlink" href="#pyfastchem-input-and-output-structures" title="Link to this heading">¶</a></h2>
<p>Running a FastChem chemistry calculation requires input and output data
structures, resembling those of the <code class="docutils literal notranslate"><span class="pre">C++</span></code> <a class="reference internal" href="cpp_class.html#sec-fastchem-input-struct"><span class="std std-ref">version</span></a>.
In Python they are represented as classes rather than a <code class="docutils literal notranslate"><span class="pre">C++</span></code><code class="docutils literal notranslate"><span class="pre">struct</span></code>.</p>
<section id="input-structure">
<h3>Input structure<a class="headerlink" href="#input-structure" title="Link to this heading">¶</a></h3>
<p>The original <code class="docutils literal notranslate"><span class="pre">C++</span></code> struct translated by <code class="docutils literal notranslate"><span class="pre">PyBind11</span></code> has the following
structure in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FastChemInput</span><span class="p">:</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pressure</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">equilibrium_condensation</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">rainout_condensation</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>The input class contains the following variables:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">temperature</span></code></dt><dd><p>An array of <code class="docutils literal notranslate"><span class="pre">float</span></code> numbers that describe the temperature in K.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pressure</span></code></dt><dd><p>An array of <code class="docutils literal notranslate"><span class="pre">float</span></code> numbers that describe the pressure in bar.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">equilibrium_condensation</span></code></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">bool</span></code> parameter that enables the calculation of equilibrium condensation. Its default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rainout_condensation</span></code></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">bool</span></code> parameter that enables the calculation of condensation via the rainout approximation. Its default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>. Note that when the flag <code class="docutils literal notranslate"><span class="pre">rainout_condensation</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the value of the parameter <code class="docutils literal notranslate"><span class="pre">equilibrium_condensation</span></code> is ignored.</p>
</dd>
</dl>
<p>An input structure, in the example here called <code class="docutils literal notranslate"><span class="pre">input_data</span></code>, can be
defined from the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_data</span> <span class="o">=</span> <span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChemInput</span><span class="p">()</span>
</pre></div>
</div>
<p>The two input arrays for temperature and pressure need to have the same
length. The <code class="docutils literal notranslate"><span class="pre">PyBind11</span></code> library allows normal Python lists or NumPy
arrays to be used here. For example, a NumPy array for the pressure
could be defined using NumPy’s <code class="docutils literal notranslate"><span class="pre">logspace</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_data</span><span class="o">.</span><span class="n">pressure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Both of these input variables need to be an array-type variable, even if
only a single temperature-pressure point is going to be calculated.</p>
</section>
<section id="output-structure">
<span id="output-structure-1"></span><h3>Output structure<a class="headerlink" href="#output-structure" title="Link to this heading">¶</a></h3>
<p>The original <code class="docutils literal notranslate"><span class="pre">C++</span></code> output struct translated by <code class="docutils literal notranslate"><span class="pre">PyBind11</span></code> has the
following structure in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FastChemOutput</span><span class="p">:</span>
    <span class="n">number_densities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
    <span class="n">total_element_density</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">mean_molecular_weight</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

    <span class="n">number_densities_cond</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
    <span class="n">element_cond_degree</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>

    <span class="n">element_conserved</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
    <span class="n">nb_chemistry_iterations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">nb_cond_iterations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">nb_iterations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">fastchem_flag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</pre></div>
</div>
<p>It has the following variables:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">number_densities</span></code></dt><dd><p>The two-dimensional array contains the number densities in of all gas phase species (elements, molecules, ions) as <code class="docutils literal notranslate"><span class="pre">float</span></code> numbers. The first dimension refers to the temperature-pressure grid and has the same size as the temperature and pressure arrays of the input structure. The second dimension refers to the number of species and has a length of <code class="docutils literal notranslate"><span class="pre">getGasSpeciesNumber()</span></code> (see <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">total_element_density</span></code></dt><dd><p>One-dimensional array of <code class="docutils literal notranslate"><span class="pre">float</span></code> numbers that contains the total number density of all atoms <span class="math notranslate nohighlight">\(i\)</span>, i.e. <span class="math notranslate nohighlight">\(n_\mathrm{tot} = \sum_i \left( n_i + \sum_j n_j \nu_{ij} + \sum_c n_c \nu_{ic} \right)\)</span>, summed over their atomic number densities, as well as the ones contained in all other molecules/ions <span class="math notranslate nohighlight">\(j\)</span> and condensates <span class="math notranslate nohighlight">\(c\)</span>. This quantity is usually only a diagnostic output and not relevant for other calculations. The dimension of the array is equal to that of the input temperature and pressure vectors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mean_molecular_weight</span></code></dt><dd><p>One-dimensional array of <code class="docutils literal notranslate"><span class="pre">float</span></code> numbers. Contains the mean molecular weight of the mixture in units of the unified atomic mass unit. For all practical purposes, this can also be converted into units of g/mol. The dimension of the array is equal to that of the input temperature and pressure vectors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">number_densities_cond</span></code></dt><dd><p>The two-dimensional array contains the fictitious number densities in of all condensate species as <code class="docutils literal notranslate"><span class="pre">float</span></code> numbers. The first dimension refers to the temperature-pressure grid and has the same size as the temperature and pressure arrays of the input structure. The second dimension refers to the number of species and has a length of <code class="docutils literal notranslate"><span class="pre">getCondSpeciesNumber()</span></code> (see <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">element_cond_degree</span></code></dt><dd><p>The two-dimensional array contains the degree of condensation for all elements. The first dimension refers to the temperature-pressure grid and has the same size as the temperature and pressure vectors of the input structure. The second dimension refers to the number of elements and has a length of <code class="docutils literal notranslate"><span class="pre">getElementNumber()</span></code> (see <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">element_conserved</span></code></dt><dd><p>The two-dimensional array of <code class="docutils literal notranslate"><span class="pre">int</span></code> numbers contains information on the state of element conservation. A value of 0 indicates that element conservation is not fulfilled, whereas a value of 1 means that the element has been conserved. The first dimension refers to the temperature-pressure grid and has the same size as the temperature and pressure vectors of the input structure. The second dimension refers to the number of elements and has a length of <code class="docutils literal notranslate"><span class="pre">getElementNumber()</span></code> (see <a class="reference internal" href="#sec-pfc-methods"><span class="std std-ref">here</span></a>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nb_chemistry_iterations</span></code></dt><dd><p>One-dimensional array of <code class="docutils literal notranslate"><span class="pre">int</span></code> numbers. Contains the total number of chemistry iterations that were required to solve the system for each temperature-pressure point. The dimension of the array is equal to that of the input temperature and pressure vectors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nb_cond_iterations</span></code></dt><dd><p>One-dimensional array of <code class="docutils literal notranslate"><span class="pre">int</span></code> numbers. Contains the total number of condensate calculation iterations that were required for each temperature-pressure point. The dimension of the array is equal to that of the input temperature and pressure vectors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nb_iterations</span></code></dt><dd><p>One-dimensional array of <code class="docutils literal notranslate"><span class="pre">int</span></code> numbers. Contains the total number of coupled condensation-gas phase chemistry calculation iterations that were required to solve the system for each temperature-pressure point. The dimension of the vector is equal to that of the input temperature and pressure vectors.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fastchem_flag</span></code></dt><dd><p>One-dimensional array of <code class="docutils literal notranslate"><span class="pre">int</span></code> numbers. Contains flags that give information on potential issues of the chemistry calculation for each temperature-pressure point. The set of potential values is stated <a class="reference internal" href="#sec-pfc-constants"><span class="std std-ref">here</span></a>. A string message for each corresponding flag can also be obtained from the constant <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_MSG</span></code> vector of strings, via <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_MSG[flag]</span></code>. The dimension of the array is equal to that of the input temperature and pressure vectors.</p>
</dd>
</dl>
<p>The output structure from the <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> module, in the example here
called <code class="docutils literal notranslate"><span class="pre">output_data</span></code>, can be defined in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output_data</span> <span class="o">=</span> <span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChemOutput</span><span class="p">()</span>
</pre></div>
</div>
<p>The arrays of the output structure don’t need to be pre-allocated. This
will be done internally within <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> when running the chemistry
calculations. If the arrays already contain data, their contents will be
overwritten. The arrays from the output structure can also be easily
converted to more practical NumPy arrays by using, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">number_densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output_data</span><span class="o">.</span><span class="n">number_densities</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="pyfastchem-functions">
<span id="sec-pfc-methods"></span><h2>pyFastChem functions<a class="headerlink" href="#pyfastchem-functions" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">pyFastChem</span></code> object returned from <code class="docutils literal notranslate"><span class="pre">pyfastchem.FastChem()</span></code> has
several methods that allow to interact with <code class="docutils literal notranslate"><span class="pre">FastChem</span></code>. These
methods are equivalent to those of the <code class="docutils literal notranslate"><span class="pre">C++</span></code> object class discussed
<a class="reference internal" href="cpp_class.html#sec-fastchem-methods"><span class="std std-ref">here</span></a>.</div>
</div>
<div class="line-block">
<div class="line">However, note that some methods listed below officially require an <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span></code>
parameter variable in their original C++ version. Since this data type doesn’t exist
in Python, PyBind11 will convert the supplied <code class="docutils literal notranslate"><span class="pre">int</span></code> value to its unsigned integer
version for C++. Even though the parameter is defined as an <code class="docutils literal notranslate"><span class="pre">int</span></code> value for Python,
only positive numbers, including 0, are accepted as valid input. Using a negative
value will result in an error message from PyBind11.</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">calcDensities</span><span class="p">(</span><span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChemInput</span><span class="p">()</span> <span class="nb">input</span><span class="p">,</span>
                  <span class="n">pyfastchem</span><span class="o">.</span><span class="n">FastChemOutput</span><span class="p">()</span> <span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Starts a chemistry calculation with the provided <code class="docutils literal notranslate"><span class="pre">pyfastchem.FastChemInput()</span></code> and <code class="docutils literal notranslate"><span class="pre">pyfastchem.FastChemOutput()</span></code> structures. Returns an <code class="docutils literal notranslate"><span class="pre">int</span></code> value that represents the highest value from the flag vector within the <code class="docutils literal notranslate"><span class="pre">pyfastchem.FastChemOutput()</span></code> structure.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setParameter</span><span class="p">(</span><span class="nb">str</span> <span class="n">param_name</span><span class="p">,</span>
             <span class="n">param_type</span> <span class="n">param_value</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Sets an internal <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> parameter. Depending on the parameter, the variable type <code class="docutils literal notranslate"><span class="pre">param_type</span></code> can either be an <code class="docutils literal notranslate"><span class="pre">int</span></code>, a <code class="docutils literal notranslate"><span class="pre">bool</span></code>, or a <code class="docutils literal notranslate"><span class="pre">float</span></code> value. A list of parameters and their types can be found <a class="reference internal" href="parameters.html#sect-fc-param"><span class="std std-ref">here</span></a>. The <code class="docutils literal notranslate"><span class="pre">C++</span></code><code class="docutils literal notranslate"><span class="pre">double</span></code> types listed there should be replaced by Python <code class="docutils literal notranslate"><span class="pre">float</span></code> values, while <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span></code> are used as <code class="docutils literal notranslate"><span class="pre">int</span></code>. <code class="docutils literal notranslate"><span class="pre">PyBind11</span></code> often converts the Python <code class="docutils literal notranslate"><span class="pre">bool</span></code> type to an integer value rather than a <code class="docutils literal notranslate"><span class="pre">C++</span></code><code class="docutils literal notranslate"><span class="pre">bool</span></code> type. Setting a boolean parameter will then result in an error message. In such a case, instead of using a simple <code class="docutils literal notranslate"><span class="pre">True</span></code> as parameter value, an explicit conversion has to be done instead, for example via <code class="docutils literal notranslate"><span class="pre">np.bool_(True)</span></code>.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getGasSpeciesNumber</span><span class="p">()</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the total number of gas phase species (atoms, ions, molecules) as <code class="docutils literal notranslate"><span class="pre">int</span></code> value.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getElementNumber</span><span class="p">()</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the total number of elements as <code class="docutils literal notranslate"><span class="pre">int</span></code> value.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getMoleculeNumber</span><span class="p">()</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the total number of molecules and ions (anything other than elements) as <code class="docutils literal notranslate"><span class="pre">int</span></code> value.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getCondSpeciesNumber</span><span class="p">()</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the total number of condensate species as <code class="docutils literal notranslate"><span class="pre">int</span></code> value.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="n">getGasSpeciesName</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the name of a gas phase species with <code class="docutils literal notranslate"><span class="pre">int</span></code> index <code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">str</span></code>; returns empty string if species does not exist.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="n">getGasSpeciesSymbol</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the symbol of an element or the formula of a molecule/ion with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">str</span></code>; returns empty string if species does not exist</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getGasSpeciesIndex</span><span class="p">(</span><span class="nb">str</span> <span class="n">symbol</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the index of a gas phase species (element/molecule/ion) with <code class="docutils literal notranslate"><span class="pre">str</span></code> symbol/formula <code class="docutils literal notranslate"><span class="pre">symbol</span></code> as <code class="docutils literal notranslate"><span class="pre">int</span></code>; returns the constant <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_UNKOWN_SPECIES</span></code> if species does not exist.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="n">getElementName</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the name of an element with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">str</span></code>; returns empty string if species does not exist.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="n">getElementSymbol</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the symbol of an element with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">str</span></code>; returns empty string if species does not exist</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getElementIndex</span><span class="p">(</span><span class="nb">str</span> <span class="n">symbol</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the index of an element with <code class="docutils literal notranslate"><span class="pre">str</span></code> symbol/formula <code class="docutils literal notranslate"><span class="pre">symbol</span></code> as <code class="docutils literal notranslate"><span class="pre">int</span></code>; returns the constant <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_UNKOWN_SPECIES</span></code> if species does not exist.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="n">getCondSpeciesName</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the name of a condensate species with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">str</span></code>; returns empty string if species does not exist.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="n">getCondSpeciesSymbol</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">getCondSpeciesIndex</span><span class="p">(</span><span class="nb">str</span> <span class="n">symbol</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the index of a condensate species with <code class="docutils literal notranslate"><span class="pre">str</span></code> symbol/formula <code class="docutils literal notranslate"><span class="pre">symbol</span></code> as <code class="docutils literal notranslate"><span class="pre">int</span></code>; returns the constant <code class="docutils literal notranslate"><span class="pre">pyfastchem.FASTCHEM_UNKOWN_SPECIES</span></code> if species does not exist.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">getElementAbundance</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns the abundance of an element with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">float</span></code>; returns 0 if the element does not exist</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="p">[]</span> <span class="n">getElementAbundance</span><span class="p">()</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the abundances of all elements as an array of <code class="docutils literal notranslate"><span class="pre">float</span></code> values; array has a length of <code class="docutils literal notranslate"><span class="pre">getElementNumber()</span></code></p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setElementAbundances</span><span class="p">(</span><span class="nb">float</span> <span class="p">[]</span> <span class="n">abundances</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Sets the abundances of all elements; the abundances are supplied as an array of <code class="docutils literal notranslate"><span class="pre">float</span></code> values, where the array has to have a size of <code class="docutils literal notranslate"><span class="pre">getElementNumber()</span></code>; if this is not the case, <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> will print an error message and leave the element abundances unchanged</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">FastChem</span><span class="o">.</span><span class="n">getGasSpeciesWeight</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the weight of a gas phase species with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">float</span></code>; returns 0 if species does not exist; for an element this refers to the atomic weight</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">FastChem</span><span class="o">.</span><span class="n">getElementWeight</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the atomic weight of an element with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">float</span></code>; returns 0 if species does not exist</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">FastChem</span><span class="o">.</span><span class="n">getCondSpeciesWeight</span><span class="p">(</span><span class="nb">int</span> <span class="n">species_index</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Returns the weight of a condensate species with <code class="docutils literal notranslate"><span class="pre">int</span></code> index<code class="docutils literal notranslate"><span class="pre">species_index</span></code> as <code class="docutils literal notranslate"><span class="pre">float</span></code>; returns 0 if species does not exist</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setVerboseLevel</span><span class="p">(</span><span class="nb">int</span> <span class="n">level</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Sets the verbose level of <code class="docutils literal notranslate"><span class="pre">FastChem</span></code>, i.e. the amount of text output in the terminal. A value of 0 will result in <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> being almost silent, whereas a value of 4 would provide a lot of debug output. A value larger than 4 will be interpreted as 4. This value will overwrite the one from the <code class="docutils literal notranslate"><span class="pre">FastChem</span></code> config file.</p>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_l.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">FastChem - Ultrafast Equilibrium Chemistry</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=exoclime&repo=fastchem&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_output.html">Standard input and output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp_standalone.html">C++ stand-alone executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyfastchem.html">Running pyFastChem</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp_class.html">Detailed C++ object class description</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Detailed pyFastChem module description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pyfastchem-constants">pyFastChem constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyfastchem-constructor">pyFastChem constructor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyfastchem-input-and-output-structures">pyFastChem input and output structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyfastchem-functions">pyFastChem functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Internal parameters</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="cpp_class.html" title="previous chapter">Detailed C++ object class description</a></li>
      <li>Next: <a href="parameters.html" title="next chapter">Internal parameters</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019 - 2023, Daniel Kitzmann, Joachim Stock.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/sections/python_module.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>